{"version":3,"file":"js/186.d7092e9c.js","mappings":"2PAiBA,MAAMA,EAAW,cACXC,EAAQ,UACRC,EAAa,YACbC,EAAc,Y,4BARpB,MAAMC,GAASC,EAAAA,EAAAA,MAETC,GAAYC,EAAAA,EAAAA,IAAI,GAChBC,GAAYD,EAAAA,EAAAA,KAAI,GAetB,SAASE,EAAYC,IACnBC,EAAAA,EAAAA,IAAYX,EAAUC,EAAOC,EAAYI,EAAWI,EACtD,CAEA,SAASE,EAAeC,GACD,IAAjBA,EAAMC,SACVD,EAAME,iBACNC,SAASC,KAAKC,UAAUC,OAAO,SAC/BR,EAAAA,EAAAA,IAAYX,EAAUC,EAAOE,EAAaK,GAAYA,EAAUY,OAClE,CASA,SAASC,EAAYD,GACnB,GAAIA,EAAME,SAAS,aACjB,GAAIF,EAAME,SAAS,OAAQ,CACzB,IAAIC,EAAKH,EAAMI,MAAM,aAAa,GAClCC,QAAQC,IAAIH,IACZI,EAAAA,EAAAA,GAAiBJ,EACnB,OACK,GAAIH,EAAME,SAAS,SACxB,GAAIF,EAAME,SAAS,OAAQ,CACzB,IAAIC,EAAKH,EAAMI,MAAM,aAAa,GAClCC,QAAQC,IAAIH,IACZK,EAAAA,EAAAA,GAAmBL,EACrB,OAEAnB,EAAOyB,KAAK,CACVC,KAAM,SACNC,OAAQ,CACNC,EAAGZ,IAIX,C,OA/CAa,EAAAA,EAAAA,KAAUC,WACRC,EAAAA,EAAAA,IAAUnC,EAAUC,EAAOC,EAAYI,SACjC6B,EAAAA,EAAAA,IAAUnC,EAAUC,EAAOE,EAAaK,GAC1CA,EAAUY,QAAUJ,SAASC,KAAKC,UAAUkB,SAAS,SACvDpB,SAASC,KAAKC,UAAUC,OAAO,OACjC,KAaFc,EAAAA,EAAAA,KAAU,KACRI,OAAOC,iBAAiB,YAAa1B,EAAe,KAEtD2B,EAAAA,EAAAA,KAAY,KACVF,OAAOG,oBAAoB,YAAa5B,EAAe,I,gXCzCzDsB,eAAeO,EAAQC,GACrB,IAAIC,EAQJ,aAPMC,EAAAA,GAAIC,mBAAmBH,GAC1BI,MAAK1B,IACJuB,EAAMvB,EAAM,YAAY,WAAW,IAEpC2B,OAAMC,IACLvB,QAAQuB,MAAM,kCAAmCA,EAAM,IAEpDL,CACT,CAEAT,eAAee,EAASC,GACtB,IACE,OAAON,EAAAA,GAAIO,gBAAgBD,EAC7B,CAAE,MAAOF,GACPvB,QAAQuB,MAAM,sBAAuBA,GACrCI,YAAW,KACTR,EAAAA,GAAIO,gBAAgBD,EAAO,GAC1B,IACL,CACF,CAEAhB,eAAemB,EAAaC,GAE1B,IAAIC,EADJ9B,QAAQC,IAAI,eAEZ,UACQkB,EAAAA,GAAIY,WAAWF,EAAK/B,IAAIuB,MAAKW,IACjCF,EAAUE,EAAI,QAAQ,GAAG,MAAM,GAEnC,CAAE,MAAOT,GACPvB,QAAQuB,MAAM,qBAAsBA,GACpCO,EAAU,CACZ,CACA9B,QAAQC,IAAI6B,GACZX,EAAAA,GAAIc,iBAAiB,UACAH,EACAD,EAAKK,OACLC,EAAAA,EAAAA,IAAiBN,EAAK/B,IACtB+B,EAAK/B,GACL+B,EAAKO,MACLP,EAAKQ,OACLR,EAAKS,MACLT,EAAKU,YAC5B,CAKO9B,eAAeP,EAAiBe,GACrC,IAAIC,QAAYF,EAAQC,GACxBjB,QAAQC,IAAIiB,GACZ,IAAK,MAAMpB,KAAMoB,EAAK,CACpB,MAAMW,QAAaL,EAAS1B,EAAGA,IAC/BE,QAAQC,IAAI4B,SACND,EAAaC,EAErB,CACF,CAEOpB,eAAeN,EAAmBqC,GACvC,MAAMX,QAAaL,EAASgB,GAC5BxC,QAAQC,IAAI4B,SACND,EAAaC,EACrB,C,wQChEA,MAAMY,GAAS3D,EAAAA,EAAAA,IAAI,IACb4D,GAAW5D,EAAAA,EAAAA,IAAI,MAGrB,SAAS6D,IACPC,EAAK,SAAU,EACjB,CACA,SAAShD,IACPgD,EAAK,SAAUH,EAAO9C,MACxB,CAEA,SAASkD,IACPH,EAAS/C,MAAMmD,OACjB,C,qWCVA,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,+FCPA,MAAMC,EAAS,CAAC,EAGVD,GAA2B,OAAgBC,EAAQ,CAAC,CAAC,SAASC,KAEpE,O,gHCHA,MAAMF,EAAc,IAEpB,e","sources":["webpack://web/./src/views/Home.vue","webpack://web/./src/tools/playlist.js","webpack://web/./src/themes/home/1.vue","webpack://web/./src/themes/home/1.vue?88c1","webpack://web/./src/themes/home/2.vue","webpack://web/./src/views/Home.vue?9051"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted, onUnmounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\n\r\nimport { initTheme, updateTheme } from '../useDB/setting.js'\r\n\r\nimport { downloadPlaylist, downloadSingleSong } from '../tools/playlist.js'\r\n\r\n// Add Theme Here\r\nimport Theme1 from '../themes/home/1.vue';\r\nimport Theme2 from '../themes/home/2.vue';\r\n\r\nconst router = useRouter()\r\n\r\nconst homeTheme = ref(1) \r\nconst darkTheme = ref(true)\r\n\r\nconst database = 'CreamPlayer'\r\nconst store = 'Setting'\r\nconst settingKey = 'homeTheme'\r\nconst settingDark = 'darkTheme'\r\n\r\nonMounted(async () => {\r\n  initTheme(database, store, settingKey, homeTheme);\r\n  await initTheme(database, store, settingDark, darkTheme);\r\n  if (darkTheme.value && !document.body.classList.contains('dark')) {\r\n    document.body.classList.toggle('dark');\r\n  }\r\n})\r\n\r\nfunction switchTheme(newValue) {\r\n  updateTheme(database, store, settingKey, homeTheme, newValue)\r\n}\r\n\r\nfunction switchDarkMode(event) {\r\n  if (event.button !== 1) return\r\n  event.preventDefault();\r\n  document.body.classList.toggle('dark');\r\n  updateTheme(database, store, settingDark, darkTheme, !darkTheme.value)\r\n}\r\nonMounted(() => {\r\n  window.addEventListener('mousedown', switchDarkMode)\r\n})\r\nonUnmounted(() => {\r\n  window.removeEventListener('mousedown', switchDarkMode)\r\n})\r\n\r\n\r\nfunction searchEnter(value) {\r\n  if (value.includes('playlist')) {\r\n    if (value.includes('id=')) {\r\n      let id = value.match(/id=(.*?)$/)[1];\r\n      console.log(id)\r\n      downloadPlaylist(id)\r\n    }\r\n  } else if (value.includes('song')) {\r\n    if (value.includes('id=')) {\r\n      let id = value.match(/id=(.*?)$/)[1];\r\n      console.log(id)\r\n      downloadSingleSong(id)\r\n    }\r\n  } else {\r\n    router.push({\r\n      name: 'search',\r\n      params: {\r\n        q: value\r\n      }  \r\n    })\r\n  }\r\n}\r\n</script>\r\n<template>\r\n  <Theme1 @search=\"searchEnter\" @switch=\"switchTheme\" v-if=\"homeTheme == 1\"></Theme1>\r\n  <Theme2 @search=\"searchEnter\" @switch=\"switchTheme\" v-if=\"homeTheme == 2\"></Theme2>\r\n</template>","import api from '../api'\r\nimport { getSongLyricsApi } from '../api'\r\n\r\nasync function loadIds(playlistId) {\r\n  let ids \r\n  await api.getPlaylistDetails(playlistId)\r\n    .then(value => {\r\n      ids = value['playlist']['trackIds']\r\n    })\r\n    .catch(error => {\r\n      console.error('Failed to get playlist details:', error)\r\n    })\r\n  return ids\r\n}\r\n\r\nasync function loadSong(songid) {\r\n  try {\r\n    return api.loadSongDetails(songid)\r\n  } catch (error) {\r\n    console.error('API request failed:', error);\r\n    setTimeout(() => {\r\n      api.loadSongDetails(songid)\r\n    }, 777);\r\n  }\r\n}\r\n\r\nasync function downloadSong(song) {\r\n  console.log('Downloading')\r\n  let songUrl\r\n  try {\r\n    await api.getSongUrl(song.id).then(res => {\r\n      songUrl = res['data'][0]['url']\r\n    })\r\n  } catch (error) {\r\n    console.error('Get Song URL fail:', error);\r\n    songUrl = 0\r\n  }\r\n  console.log(songUrl)\r\n  api.downloadSongFile('netease',\r\n                       songUrl, \r\n                       song.cover, \r\n                       getSongLyricsApi(song.id),\r\n                       song.id, \r\n                       song.title, \r\n                       song.artist, \r\n                       song.album, \r\n                       song.publishTime)\r\n}\r\n\r\nfunction sleep(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\nexport async function downloadPlaylist(playlistId) {\r\n  let ids = await loadIds(playlistId)\r\n  console.log(ids)\r\n  for (const id of ids) {\r\n    const song = await loadSong(id.id)\r\n    console.log(song)\r\n    await downloadSong(song)\r\n    // await sleep(777); \r\n  }\r\n}\r\n\r\nexport async function downloadSingleSong(songId) {\r\n  const song = await loadSong(songId)\r\n  console.log(song)\r\n  await downloadSong(song)\r\n}","<script setup>\r\nimport { ref } from 'vue'\r\n\r\nconst search = ref('')\r\nconst inputRef = ref(null)\r\n\r\nconst emit = defineEmits(['switch', 'search']) \r\nfunction changeTheme() {\r\n  emit('switch', 1)\r\n}\r\nfunction searchEnter() {\r\n  emit('search', search.value)\r\n}\r\n\r\nfunction onClick() {\r\n  inputRef.value.focus()\r\n}\r\n</script>\r\n<template>\r\n  <div class=\"home\" @contextmenu.prevent=\"changeTheme\" @click=\"onClick\">\r\n      <div class=\"home-search\">\r\n        <input class=\"home-input\" placeholder=\"歌曲名或歌单歌曲链接\" v-model=\"search\" @keyup.enter=\"searchEnter\" autofocus ref=\"inputRef\"> \r\n      </div>\r\n    </div>\r\n</template>\r\n<style scoped>\r\n.home {\r\n  position: absolute;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n.home-input {\r\n  border: 1px solid;\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  width: 99%;\r\n  transform: translate(-50%, -50%);\r\n  font-size: 7.7vw; \r\n  text-align: center;\r\n  border-color: transparent;\r\n}\r\n.home-input:focus {\r\n  outline: none;\r\n  border: none;\r\n}\r\n\r\nbody.dark .home-input {\r\n  color: #c4c4c4;\r\n  background-color: black;\r\n}\r\n</style>","import script from \"./1.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./1.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./1.vue?vue&type=style&index=0&id=df52087a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-df52087a\"]])\n\nexport default __exports__","import { render } from \"./2.vue?vue&type=template&id=0a51daa6\"\nconst script = {}\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import script from \"./Home.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Home.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["database","store","settingKey","settingDark","router","useRouter","homeTheme","ref","darkTheme","switchTheme","newValue","updateTheme","switchDarkMode","event","button","preventDefault","document","body","classList","toggle","value","searchEnter","includes","id","match","console","log","downloadPlaylist","downloadSingleSong","push","name","params","q","onMounted","async","initTheme","contains","window","addEventListener","onUnmounted","removeEventListener","loadIds","playlistId","ids","api","getPlaylistDetails","then","catch","error","loadSong","songid","loadSongDetails","setTimeout","downloadSong","song","songUrl","getSongUrl","res","downloadSongFile","cover","getSongLyricsApi","title","artist","album","publishTime","songId","search","inputRef","changeTheme","emit","onClick","focus","__exports__","script","render"],"sourceRoot":""}